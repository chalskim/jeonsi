<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í∏∞ÏóÖ Ïû•Î∞îÍµ¨Îãà - SuperSlice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding-bottom: 140px; /* Î∞îÌÖÄÏãúÌä∏ Í≥µÍ∞Ñ ÌôïÎ≥¥ */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 24px;
        }

        .header h1 {
            font-size: 28px;
            color: #2c3e50;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 16px;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .controls-left {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .select-all-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .select-all-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .select-all-group label {
            font-weight: 500;
            color: #555;
            cursor: pointer;
            user-select: none;
        }

        .filter-group {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group label {
            font-weight: 500;
            color: #555;
        }

        select, input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #219a52;
        }

        .cart-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }

        .cart-item {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .cart-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
        }

        .cart-item-header {
            padding: 16px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-item-body {
            padding: 20px;
            display: flex;
            gap: 20px;
        }

        .item-checkbox {
            display: flex;
            align-items: flex-start;
            padding-top: 5px;
        }

        .item-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .item-image {
            width: 140px;
            height: 140px;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .item-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }

        .item-image-text {
            position: relative;
            z-index: 1;
            text-align: center;
            padding: 10px;
        }

        .item-details {
            flex-grow: 1;
        }

        .item-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .item-description {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 16px;
            line-height: 1.5;
        }

        .item-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 16px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: #555;
            background: #f8f9fa;
            padding: 4px 8px;
            border-radius: 4px;
        }

        .item-price-section {
            display: flex;
            align-items: baseline;
            gap: 12px;
            margin-bottom: 16px;
        }

        .item-price {
            font-size: 24px;
            font-weight: 700;
            color: #e74c3c;
        }

        .item-original-price {
            font-size: 16px;
            color: #95a5a6;
            text-decoration: line-through;
        }

        .discount-badge {
            background: #e74c3c;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .item-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }

        .quantity-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-size: 18px;
            transition: background 0.2s;
        }

        .quantity-btn:hover {
            background: #e9ecef;
        }

        .quantity-input {
            width: 60px;
            height: 40px;
            text-align: center;
            border: none;
            font-size: 16px;
            font-weight: 500;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }

        .btn-outline {
            background: white;
            color: #3498db;
            border: 1px solid #3498db;
        }

        .btn-outline:hover {
            background: #3498db;
            color: white;
        }

        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .badge-new {
            background: #e74c3c;
            color: white;
        }

        .badge-sale {
            background: #f39c12;
            color: white;
        }

        .category-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .category-premium {
            background: #e8f4fd;
            color: #0066cc;
        }

        .category-standard {
            background: #f0f0f0;
            color: #666;
        }

        .category-basic {
            background: #fff8e1;
            color: #f57c00;
        }

        /* Ïø†Ìè∞ ÏÑπÏÖò */
        .coupon-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 20px;
            margin-bottom: 24px;
        }

        .coupon-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .coupon-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .coupon-input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .coupon-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
        }

        .coupon-selector-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .coupon-selector-label {
            font-size: 14px;
            font-weight: 500;
            color: #555;
        }

        .coupon-selector {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        .coupon-selector:focus {
            outline: none;
            border-color: #3498db;
        }

        .coupon-applied-info {
            margin-top: 12px;
            padding: 12px;
            background: #e8f4fd;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .coupon-applied-text {
            font-size: 14px;
            color: #0066cc;
            font-weight: 500;
        }

        .btn-remove-coupon {
            background: #e74c3c;
            color: white;
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 4px;
        }

        .btn-remove-coupon:hover {
            background: #c0392b;
        }

        /* Î∞îÌÖÄÏãúÌä∏ Ïä§ÌÉÄÏùº */
        .bottom-sheet {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top-left-radius: 16px;
            border-top-right-radius: 16px;
            box-shadow: 0 -2px 16px rgba(0,0,0,0.15);
            z-index: 100;
            transform: translateY(0);
            transition: transform 0.3s ease;
        }

        .bottom-sheet-handle {
            width: 40px;
            height: 4px;
            background: #ddd;
            border-radius: 2px;
            margin: 8px auto;
        }

        .bottom-sheet-content {
            padding: 16px 24px;
        }

        .sheet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .sheet-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .sheet-summary {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .summary-item {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            min-width: 120px;
        }

        .summary-label {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 4px;
        }

        .summary-value {
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50;
        }

        .summary-discount {
            color: #e74c3c;
        }

        .summary-total {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
        }

        .sheet-actions {
            display: flex;
            gap: 12px;
        }

        .btn-cancel {
            background: #95a5a6;
            color: white;
            flex: 1;
            padding: 14px 0;
            font-size: 16px;
            font-weight: 600;
        }

        .btn-cancel:hover {
            background: #7f8c8d;
        }

        .btn-payment {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 2;
            padding: 14px 0;
            font-size: 16px;
            font-weight: 600;
        }

        .btn-payment:hover {
            opacity: 0.9;
        }

        .btn-payment:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        .empty-cart {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .empty-cart-icon {
            font-size: 64px;
            color: #bdc3c7;
            margin-bottom: 20px;
        }

        .empty-cart-title {
            font-size: 22px;
            font-weight: 600;
            color: #7f8c8d;
            margin-bottom: 8px;
        }

        .empty-cart-description {
            color: #95a5a6;
            margin-bottom: 24px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .controls-left {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .filter-group {
                flex-direction: column;
                align-items: stretch;
            }

            .cart-item-body {
                flex-direction: column;
            }

            .item-image {
                width: 100%;
                height: 200px;
            }

            .item-actions {
                flex-direction: column;
                gap: 12px;
            }

            .action-buttons {
                width: 100%;
                justify-content: flex-end;
            }

            .sheet-summary {
                flex-direction: column;
                gap: 8px;
            }

            .summary-item {
                align-items: flex-start;
            }

            .coupon-input-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <span>üõí</span>
                Í∏∞ÏóÖ Ïû•Î∞îÍµ¨Îãà
            </h1>
            <p>ÏÑ†ÌÉùÌïú ÏÉÅÌíàÏùÑ ÌôïÏù∏ÌïòÍ≥† Ï£ºÎ¨∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.</p>
        </div>

        <div class="controls">
            <div class="controls-left">
                <div class="select-all-group">
                    <input type="checkbox" id="selectAllCheckbox" onchange="toggleSelectAll()">
                    <label for="selectAllCheckbox">Ï†ÑÏ≤¥ÏÑ†ÌÉù</label>
                </div>
                <div class="filter-group">
                    <label for="categoryFilter">Ïπ¥ÌÖåÍ≥†Î¶¨:</label>
                    <select id="categoryFilter">
                        <option value="all">Ï†ÑÏ≤¥</option>
                        <option value="premium">ÌîÑÎ¶¨ÎØ∏ÏóÑ</option>
                        <option value="standard">Ïä§ÌÉ†Îã§Îìú</option>
                        <option value="basic">Î≤†Ïù¥ÏßÅ</option>
                    </select>

                    <input type="text" id="searchInput" placeholder="ÏÉÅÌíàÎ™ÖÏúºÎ°ú Í≤ÄÏÉâ...">
                </div>
            </div>
            <div class="filter-group">
                <button class="btn btn-danger" onclick="deleteSelectedItems()">ÏÑ†ÌÉù ÏÇ≠Ï†ú</button>
            </div>
        </div>

        <div id="cartContainer" class="cart-container">
            <!-- Ïû•Î∞îÍµ¨Îãà ÏïÑÏù¥ÌÖúÏùÄ JavaScriptÎ°ú ÎèôÏ†Å ÏÉùÏÑ± -->
        </div>

        <!-- Ïø†Ìè∞ ÏÑπÏÖò -->
        <div class="coupon-section">
            <div class="coupon-header">
                <div class="coupon-title">
                    <span>üé´</span>
                    Ïø†Ìè∞ Ï†ÅÏö©
                </div>
            </div>
            <div class="coupon-input-group">
                <input type="text" class="coupon-input" id="couponCode" placeholder="Ïø†Ìè∞ ÏΩîÎìúÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                <button class="btn btn-primary" onclick="applyCoupon()">Ï†ÅÏö©</button>
            </div>
            <div class="coupon-selector-group">
                <label class="coupon-selector-label">Î≥¥Ïú† Ïø†Ìè∞ ÏÑ†ÌÉù</label>
                <select class="coupon-selector" id="couponSelector" onchange="selectCouponFromDropdown()">
                    <option value="">Ïø†Ìè∞ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                </select>
            </div>
            <div id="couponAppliedInfo" class="coupon-applied-info" style="display: none;">
                <span class="coupon-applied-text" id="appliedCouponText"></span>
                <button class="btn-remove-coupon" onclick="removeCoupon()">Ïø†Ìè∞ Ï†úÍ±∞</button>
            </div>
        </div>

        <div id="emptyCart" class="empty-cart" style="display: none;">
            <div class="empty-cart-icon">üõí</div>
            <div class="empty-cart-title">Ïû•Î∞îÍµ¨ÎãàÍ∞Ä ÎπÑÏñ¥ÏûàÏäµÎãàÎã§</div>
            <div class="empty-cart-description">ÏÉÅÌíàÏùÑ Ïû•Î∞îÍµ¨ÎãàÏóê Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî</div>
            <button class="btn btn-primary">ÏÉÅÌíà Î≥¥Îü¨Í∞ÄÍ∏∞</button>
        </div>
    </div>

    <!-- Í≤∞Ï†ú ÏöîÏïΩ Î∞îÌÖÄÏãúÌä∏ -->
    <div id="bottomSheet" class="bottom-sheet">
        <div class="bottom-sheet-handle"></div>
        <div class="bottom-sheet-content">
            <div class="sheet-header">
                <div class="sheet-title">Ï£ºÎ¨∏ ÏöîÏïΩ</div>
                <div id="selectedCount">0Í∞ú ÏÉÅÌíà ÏÑ†ÌÉù</div>
            </div>
            <div class="sheet-summary">
                <div class="summary-item">
                    <div class="summary-label">ÏÉÅÌíà Í∏àÏï°</div>
                    <div class="summary-value" id="subtotal">‚Ç©0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Ìï†Ïù∏ Í∏àÏï°</div>
                    <div class="summary-value summary-discount" id="discount">-‚Ç©0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Î∂ÄÍ∞ÄÏÑ∏</div>
                    <div class="summary-value" id="tax">‚Ç©0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Ìï©Í≥Ñ</div>
                    <div class="summary-value summary-total" id="total">‚Ç©0</div>
                </div>
            </div>
            <div class="sheet-actions">
                <button class="btn btn-cancel" onclick="handleCancel()">ÏáºÌïë Í≥ÑÏÜç</button>
                <button class="btn btn-payment" id="paymentBtn" onclick="handlePayment()">Í≤∞Ï†úÌïòÍ∏∞</button>
            </div>
        </div>
    </div>

    <script>
        // Í∏∞ÏóÖ Ïû•Î∞îÍµ¨Îãà Î™©ÏóÖ Îç∞Ïù¥ÌÑ∞
        let cartItems = [
            {
                id: "item1",
                title: "ÏÉÅÎã® Î∞∞ÎÑà Í¥ëÍ≥†",
                description: "Î©îÏù∏ ÌéòÏù¥ÏßÄ ÏÉÅÎã® ÎÖ∏Ï∂ú (ÏùºÍ∞Ñ)",
                type: "Î∞∞ÎÑà",
                category: "premium",
                originalPrice: 60000,
                price: 50000,
                discountRate: 17,
                quantity: 1,
                duration: "1Ïùº",
                company: "ÌÖåÌÅ¨ÏÜîÎ£®ÏÖò",
                businessNumber: "123-45-67890",
                department: "ÎßàÏºÄÌåÖÌåÄ",
                manager: "ÍπÄÎßàÏºÄÌåÖ",
                contact: "02-1234-5678",
                selected: true
            },
            {
                id: "item2",
                title: "Ï†ÑÎ¨∏Í∞Ä ÌîÑÎ°úÌïÑ Ï∂îÏ≤ú",
                description: "Í≤ÄÏÉâ Í≤∞Í≥º ÏÉÅÎã® ÎÖ∏Ï∂ú (Ï£ºÍ∞Ñ)",
                type: "ÌîÑÎ°úÎ™®ÏÖò",
                category: "standard",
                originalPrice: 400000,
                price: 350000,
                discountRate: 13,
                quantity: 2,
                duration: "7Ïùº",
                company: "Ïù∏ÏÇ¨Ïù¥Ìä∏Ïª®ÏÑ§ÌåÖ",
                businessNumber: "987-65-43210",
                department: "ÏòÅÏóÖÌåÄ",
                manager: "Ïù¥ÏòÅÏóÖ",
                contact: "02-9876-5432",
                selected: true
            },
            {
                id: "item3",
                title: "Ï±ÑÏö©Í≥µÍ≥† ÌïòÏù¥ÎùºÏù¥Ìä∏",
                description: "Í∏¥Í∏â Ï±ÑÏö© ÏÑπÏÖò ÎÖ∏Ï∂ú (ÏõîÍ∞Ñ)",
                type: "Ï±ÑÏö©",
                category: "premium",
                originalPrice: 900000,
                price: 800000,
                discountRate: 11,
                quantity: 1,
                duration: "30Ïùº",
                company: "HRÌçºÏä§Ìä∏",
                businessNumber: "456-78-90123",
                department: "Ïù∏ÏÇ¨ÌåÄ",
                manager: "Î∞ïÏù∏ÏÇ¨",
                contact: "02-5555-6666",
                selected: false
            },
            {
                id: "item4",
                title: "ÍµêÏú°Í≥ºÏ†ï Î∞∞ÎÑà",
                description: "ÍµêÏú° ÌéòÏù¥ÏßÄ ÏÇ¨Ïù¥Îìú Î∞∞ÎÑà (2Ï£ºÍ∞Ñ)",
                type: "Î∞∞ÎÑà",
                category: "standard",
                originalPrice: 250000,
                price: 200000,
                discountRate: 20,
                quantity: 1,
                duration: "14Ïùº",
                company: "ÏóêÎìÄÌÖåÌÅ¨ÏΩîÎ¶¨ÏïÑ",
                businessNumber: "321-09-87654",
                department: "ÍµêÏú°ÏÇ¨ÏóÖÌåÄ",
                manager: "ÏµúÏóêÎìÄ",
                contact: "02-3333-4444",
                selected: true
            },
            {
                id: "item5",
                title: "Ïù∏Ï¶ùÏª®ÏÑ§ÌåÖ ÌåùÏóÖ Í¥ëÍ≥†",
                description: "Î°úÍ∑∏Ïù∏ ÌõÑ ÌåùÏóÖ Í¥ëÍ≥† (3ÏùºÍ∞Ñ)",
                type: "ÌåùÏóÖ",
                category: "basic",
                originalPrice: 180000,
                price: 150000,
                discountRate: 17,
                quantity: 3,
                duration: "3Ïùº",
                company: "Î≥¥ÏïàÍ∞ÄÎìú",
                businessNumber: "654-32-10987",
                department: "ITÌåÄ",
                manager: "Ï†ïÎ≥¥Ïïà",
                contact: "02-7777-8888",
                selected: false
            }
        ];

        // Ïø†Ìè∞ Îç∞Ïù¥ÌÑ∞
        const coupons = [
            {
                id: "coupon1",
                name: "Í∏∞ÏóÖ Ï≤´ Íµ¨Îß§ 10% Ìï†Ïù∏",
                description: "Í∏∞ÏóÖ Ï≤´ Íµ¨Îß§ Ïãú 10% Ìï†Ïù∏ (ÏµúÎåÄ 100,000Ïõê)",
                type: "percentage",
                value: 10,
                maxDiscount: 100000,
                minAmount: 100000
            },
            {
                id: "coupon2",
                name: "ÎåÄÎüâ Íµ¨Îß§ 5% Ìï†Ïù∏",
                description: "50ÎßåÏõê Ïù¥ÏÉÅ Íµ¨Îß§ Ïãú 5% Ìï†Ïù∏",
                type: "percentage",
                value: 5,
                maxDiscount: 50000,
                minAmount: 500000
            },
            {
                id: "coupon3",
                name: "Î∂ÑÍ∏∞Î≥Ñ ÌîÑÎ°úÎ™®ÏÖò 15% Ìï†Ïù∏",
                description: "Î∂ÑÍ∏∞Î≥Ñ ÌîÑÎ°úÎ™®ÏÖò 15% Ìï†Ïù∏ Ïø†Ìè∞",
                type: "percentage",
                value: 15,
                maxDiscount: 200000,
                minAmount: 300000
            },
            {
                id: "coupon4",
                name: "Ï†ïÍ∏∞ Í≥ÑÏïΩ 100,000Ïõê Ìï†Ïù∏",
                description: "Ï†ïÍ∏∞ Í≥ÑÏïΩ Ïãú 100,000Ïõê Ìï†Ïù∏",
                type: "fixed",
                value: 100000,
                minAmount: 200000
            }
        ];

        let filteredItems = [...cartItems];
        let appliedCoupon = null;

        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            renderCart();
            renderCouponSelector();
            updatePaymentSummary();
            updateSelectAllCheckbox();

            // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
            document.getElementById('categoryFilter').addEventListener('change', filterItems);
            document.getElementById('searchInput').addEventListener('input', filterItems);
        });

        // Ïû•Î∞îÍµ¨Îãà Î†åÎçîÎßÅ
        function renderCart() {
            const container = document.getElementById('cartContainer');
            const emptyCart = document.getElementById('emptyCart');
            
            container.innerHTML = '';

            if (filteredItems.length === 0) {
                container.style.display = 'none';
                emptyCart.style.display = 'block';
                return;
            }

            container.style.display = 'grid';
            emptyCart.style.display = 'none';

            filteredItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item';
                itemElement.innerHTML = `
                    <div class="cart-item-header">
                        <div>
                            <span class="category-badge category-${item.category}">${getCategoryText(item.category)}</span>
                            <span style="margin-left: 8px; font-size: 14px; color: #7f8c8d;">${item.company}</span>
                        </div>
                        <button class="btn btn-sm btn-danger" onclick="removeItem('${item.id}')">ÏÇ≠Ï†ú</button>
                    </div>
                    <div class="cart-item-body">
                        <div class="item-checkbox">
                            <input type="checkbox" id="checkbox-${item.id}" ${item.selected ? 'checked' : ''} 
                                   onchange="toggleItemSelection('${item.id}')">
                        </div>
                        <div class="item-image">
                            <div class="item-image-text">
                                <div style="font-size: 24px; margin-bottom: 8px;">üì¢</div>
                                <div>${item.type}</div>
                            </div>
                        </div>
                        <div class="item-details">
                            <div class="item-title">${item.title}</div>
                            <div class="item-description">${item.description}</div>
                            <div class="item-meta">
                                <div class="meta-item"><span>‚è±Ô∏è</span><span>${item.duration}</span></div>
                                <div class="meta-item"><span>üè¢</span><span>${item.company}</span></div>
                                <div class="meta-item"><span>üë§</span><span>${item.manager}</span></div>
                            </div>
                            <div class="item-price-section">
                                <div class="item-price">‚Ç©${(item.price * item.quantity).toLocaleString()}</div>
                                ${item.originalPrice > item.price ? `
                                    <div class="item-original-price">‚Ç©${(item.originalPrice * item.quantity).toLocaleString()}</div>
                                    <div class="discount-badge">${item.discountRate}%</div>
                                ` : ''}
                            </div>
                            <div class="item-actions">
                                <div class="quantity-control">
                                    <button class="quantity-btn" onclick="decreaseQuantity('${item.id}')">-</button>
                                    <input type="number" class="quantity-input" id="quantity-${item.id}" 
                                           value="${item.quantity}" min="1" onchange="updateQuantity('${item.id}')">
                                    <button class="quantity-btn" onclick="increaseQuantity('${item.id}')">+</button>
                                </div>
                                <div class="action-buttons">
                                    <button class="btn btn-outline btn-sm" onclick="viewDetails('${item.id}')">ÏÉÅÏÑ∏ Ï†ïÎ≥¥</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(itemElement);
            });
        }

        // Ïø†Ìè∞ ÏÖÄÎ†âÌÑ∞ Î†åÎçîÎßÅ
        function renderCouponSelector() {
            const selector = document.getElementById('couponSelector');
            selector.innerHTML = '<option value="">Ïø†Ìè∞ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>';
            
            coupons.forEach(coupon => {
                const option = document.createElement('option');
                option.value = coupon.id;
                option.textContent = `${coupon.name} (${coupon.type === 'percentage' ? coupon.value + '%' : '‚Ç©' + coupon.value.toLocaleString() + ' Ìï†Ïù∏'})`;
                selector.appendChild(option);
            });
        }

        // ÌïÑÌÑ∞ÎßÅ
        function filterItems() {
            const categoryFilter = document.getElementById('categoryFilter').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            filteredItems = cartItems.filter(item => {
                const categoryMatch = categoryFilter === 'all' || item.category === categoryFilter;
                const searchMatch = item.title.toLowerCase().includes(searchTerm) ||
                                  item.description.toLowerCase().includes(searchTerm);

                return categoryMatch && searchMatch;
            });

            renderCart();
            updateSelectAllCheckbox();
        }

        // Ï†ÑÏ≤¥ÏÑ†ÌÉù/Ìï¥Ï†ú Í∏∞Îä•
        function toggleSelectAll() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            const isChecked = selectAllCheckbox.checked;

            filteredItems.forEach(item => {
                item.selected = isChecked;
            });

            renderCart();
            updatePaymentSummary();
        }

        // Ï†ÑÏ≤¥ÏÑ†ÌÉù Ï≤¥ÌÅ¨Î∞ïÏä§ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        function updateSelectAllCheckbox() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            
            if (filteredItems.length === 0) {
                selectAllCheckbox.checked = false;
                selectAllCheckbox.disabled = true;
                return;
            }

            const selectedCount = filteredItems.filter(item => item.selected).length;
            selectAllCheckbox.checked = selectedCount === filteredItems.length;
            selectAllCheckbox.disabled = false;
        }

        // ÏàòÎüâ Ï°∞Ï†à
        function increaseQuantity(id) {
            const item = cartItems.find(i => i.id === id);
            if (item) {
                item.quantity++;
                document.getElementById(`quantity-${id}`).value = item.quantity;
                renderCart();
                updatePaymentSummary();
                updateSelectAllCheckbox();
            }
        }

        function decreaseQuantity(id) {
            const item = cartItems.find(i => i.id === id);
            if (item && item.quantity > 1) {
                item.quantity--;
                document.getElementById(`quantity-${id}`).value = item.quantity;
                renderCart();
                updatePaymentSummary();
                updateSelectAllCheckbox();
            }
        }

        function updateQuantity(id) {
            const item = cartItems.find(i => i.id === id);
            const input = document.getElementById(`quantity-${id}`);
            const newQuantity = parseInt(input.value);

            if (item && newQuantity > 0) {
                item.quantity = newQuantity;
                renderCart();
                updatePaymentSummary();
                updateSelectAllCheckbox();
            } else {
                input.value = item.quantity;
            }
        }

        // ÏïÑÏù¥ÌÖú ÏÑ†ÌÉù
        function toggleItemSelection(id) {
            const item = cartItems.find(i => i.id === id);
            if (item) {
                item.selected = !item.selected;
                updatePaymentSummary();
                updateSelectAllCheckbox();
            }
        }

        // ÏïÑÏù¥ÌÖú ÏÇ≠Ï†ú
        function removeItem(id) {
            if (confirm('Ïù¥ ÏÉÅÌíàÏùÑ Ïû•Î∞îÍµ¨ÎãàÏóêÏÑú ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                cartItems = cartItems.filter(item => item.id !== id);
                filterItems();
                updatePaymentSummary();
            }
        }

        // ÏÑ†ÌÉùÎêú ÏïÑÏù¥ÌÖú ÏÇ≠Ï†ú
        function deleteSelectedItems() {
            const selectedItems = cartItems.filter(item => item.selected);
            
            if (selectedItems.length === 0) {
                alert('ÏÇ≠Ï†úÌï† ÏÉÅÌíàÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (confirm(`ÏÑ†ÌÉùÎêú ${selectedItems.length}Í∞ú ÏÉÅÌíàÏùÑ Ïû•Î∞îÍµ¨ÎãàÏóêÏÑú ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                cartItems = cartItems.filter(item => !item.selected);
                filterItems();
                updatePaymentSummary();
            }
        }

        // Ïø†Ìè∞ Í¥ÄÎ†® Ìï®Ïàò
        function applyCoupon() {
            const couponCode = document.getElementById('couponCode').value.trim();
            if (!couponCode) {
                alert('Ïø†Ìè∞ ÏΩîÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            // Ïó¨Í∏∞ÏÑú Ïã§Ï†ú Ïø†Ìè∞ Í≤ÄÏ¶ù Î°úÏßÅÏù¥ Îì§Ïñ¥Í∞ÄÏïº Ìï®
            alert('Ï°¥Ïû¨ÌïòÏßÄ ÏïäÎäî Ïø†Ìè∞ ÏΩîÎìúÏûÖÎãàÎã§.');
            document.getElementById('couponCode').value = '';
        }

        function selectCouponFromDropdown() {
            const selector = document.getElementById('couponSelector');
            const couponId = selector.value;
            
            if (!couponId) {
                removeCoupon();
                return;
            }

            const coupon = coupons.find(c => c.id === couponId);
            if (!coupon) return;

            const selectedItems = cartItems.filter(item => item.selected);
            const subtotal = selectedItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            if (coupon.minAmount && subtotal < coupon.minAmount) {
                alert(`ÏµúÏÜå ${coupon.minAmount.toLocaleString()}Ïõê Ïù¥ÏÉÅ Íµ¨Îß§ Ïãú ÏÇ¨Ïö© Í∞ÄÎä•Ìï©ÎãàÎã§.`);
                selector.value = '';
                return;
            }

            appliedCoupon = coupon;
            updateCouponDisplay();
            updatePaymentSummary();
            alert('Ïø†Ìè∞Ïù¥ Ï†ÅÏö©ÎêòÏóàÏäµÎãàÎã§.');
        }

        function updateCouponDisplay() {
            const appliedInfo = document.getElementById('couponAppliedInfo');
            const appliedText = document.getElementById('appliedCouponText');
            const selector = document.getElementById('couponSelector');

            if (appliedCoupon) {
                appliedInfo.style.display = 'flex';
                appliedText.textContent = `Ï†ÅÏö©Îêú Ïø†Ìè∞: ${appliedCoupon.name}`;
                selector.value = appliedCoupon.id;
            } else {
                appliedInfo.style.display = 'none';
                selector.value = '';
            }
        }

        function removeCoupon() {
            appliedCoupon = null;
            updateCouponDisplay();
            updatePaymentSummary();
            alert('Ïø†Ìè∞Ïù¥ Ï†úÍ±∞ÎêòÏóàÏäµÎãàÎã§.');
        }

        // Í≤∞Ï†ú Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
        function updatePaymentSummary() {
            const selectedItems = cartItems.filter(item => item.selected);
            const count = selectedItems.length;
            let subtotal = 0;

            selectedItems.forEach(item => {
                subtotal += item.price * item.quantity;
            });

            // Ìï†Ïù∏ Í≥ÑÏÇ∞
            let discount = 0;
            if (appliedCoupon) {
                if (appliedCoupon.type === 'percentage') {
                    discount = Math.floor(subtotal * appliedCoupon.value / 100);
                    if (appliedCoupon.maxDiscount) {
                        discount = Math.min(discount, appliedCoupon.maxDiscount);
                    }
                } else {
                    discount = appliedCoupon.value;
                }
            }

            // Î∂ÄÍ∞ÄÏÑ∏ Í≥ÑÏÇ∞
            const taxableAmount = subtotal - discount;
            const tax = Math.floor(taxableAmount * 0.1);
            const total = taxableAmount + tax;

            document.getElementById('selectedCount').textContent = `${count}Í∞ú ÏÉÅÌíà ÏÑ†ÌÉù`;
            document.getElementById('subtotal').textContent = `‚Ç©${subtotal.toLocaleString()}`;
            document.getElementById('discount').textContent = `-‚Ç©${discount.toLocaleString()}`;
            document.getElementById('tax').textContent = `‚Ç©${tax.toLocaleString()}`;
            document.getElementById('total').textContent = `‚Ç©${total.toLocaleString()}`;

            // Í≤∞Ï†ú Î≤ÑÌäº ÌôúÏÑ±Ìôî/ÎπÑÌôúÏÑ±Ìôî
            const paymentBtn = document.getElementById('paymentBtn');
            paymentBtn.disabled = count === 0;
        }

        // Í≤∞Ï†ú Ï≤òÎ¶¨
        function handlePayment() {
            const selectedItems = cartItems.filter(item => item.selected);

            if (selectedItems.length === 0) {
                alert('Í≤∞Ï†úÌï† ÏÉÅÌíàÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            const itemTitles = selectedItems.map(item => `${item.title} (${item.quantity}Í∞ú)`).join(', ');
            const subtotal = selectedItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            let discount = 0;
            if (appliedCoupon) {
                if (appliedCoupon.type === 'percentage') {
                    discount = Math.floor(subtotal * appliedCoupon.value / 100);
                    if (appliedCoupon.maxDiscount) {
                        discount = Math.min(discount, appliedCoupon.maxDiscount);
                    }
                } else {
                    discount = appliedCoupon.value;
                }
            }

            const taxableAmount = subtotal - discount;
            const tax = Math.floor(taxableAmount * 0.1);
            const total = taxableAmount + tax;

            const confirmMessage = `Îã§Ïùå ÏÉÅÌíàÏùÑ Í≤∞Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\nÏÉÅÌíà: ${itemTitles}\nÏÉÅÌíà Í∏àÏï°: ‚Ç©${subtotal.toLocaleString()}\nÌï†Ïù∏ Í∏àÏï°: -‚Ç©${discount.toLocaleString()}\nÎ∂ÄÍ∞ÄÏÑ∏: ‚Ç©${tax.toLocaleString()}\nÏ¥ù Í≤∞Ï†ú Í∏àÏï°: ‚Ç©${total.toLocaleString()}`;

            if (confirm(confirmMessage)) {
                // Í≤∞Ï†ú Ï≤òÎ¶¨ Î°úÏßÅ (Ïã§Ï†úÎ°úÎäî Í≤∞Ï†ú API Ìò∏Ï∂ú)
                alert('Í≤∞Ï†úÍ∞Ä ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!');
                
                // Í≤∞Ï†ú ÏôÑÎ£åÎêú ÏÉÅÌíàÏùÄ Ïû•Î∞îÍµ¨ÎãàÏóêÏÑú Ï†úÍ±∞
                cartItems = cartItems.filter(item => !item.selected);
                filterItems();
                updatePaymentSummary();
            }
        }

        // Ï∑®ÏÜå Ï≤òÎ¶¨
        function handleCancel() {
            window.location.href = '/enterprise/products'; // Í∏∞ÏóÖ ÏÉÅÌíà Î™©Î°ù ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
        }

        // ÏÉÅÏÑ∏ Ï†ïÎ≥¥ Î≥¥Í∏∞
        function viewDetails(id) {
            const item = cartItems.find(i => i.id === id);
            if (item) {
                alert(`${item.title}\n\n${item.description}\n\nÌöåÏÇ¨: ${item.company}\nÎã¥ÎãπÏûê: ${item.manager}\nÏó∞ÎùΩÏ≤ò: ${item.contact}\nÍ∞ÄÍ≤©: ‚Ç©${item.price.toLocaleString()}`);
            }
        }

        // Ïú†Ìã∏Î¶¨Ìã∞ Ìï®Ïàò
        function getCategoryText(category) {
            const categoryMap = {
                'premium': 'ÌîÑÎ¶¨ÎØ∏ÏóÑ',
                'standard': 'Ïä§ÌÉ†Îã§Îìú',
                'basic': 'Î≤†Ïù¥ÏßÅ'
            };
            return categoryMap[category] || category;
        }
    </script>
</body>
</html>
